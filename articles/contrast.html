<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Contrast vs. conditional plots • visreg</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Contrast vs. conditional plots">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">visreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.7.0.16</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-basic-framework" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Basic framework</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-basic-framework">
<li><a class="dropdown-item" href="../articles/basic.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/contrast.html">Contrast vs. conditional plots</a></li>
    <li><a class="dropdown-item" href="../articles/trans.html">Transformations</a></li>
    <li><a class="dropdown-item" href="../articles/cond.html">Conditioning</a></li>
    <li><a class="dropdown-item" href="../articles/options.html">Graphical options</a></li>
    <li><a class="dropdown-item" href="../articles/gg.html">Visreg and ggplot2</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-models-with-interactions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Models with interactions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-models-with-interactions">
<li><a class="dropdown-item" href="../articles/cross.html">Cross-sectional plots</a></li>
    <li><a class="dropdown-item" href="../articles/overlay.html">Overlay plots</a></li>
    <li><a class="dropdown-item" href="../articles/surface.html">Surface plots</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-models-with-interactions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Models with interactions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-models-with-interactions">
<li><a class="dropdown-item" href="../articles/glm.html">GLMs</a></li>
    <li><a class="dropdown-item" href="../articles/blackbox.html">Forests, SVMs, etc.</a></li>
    <li><a class="dropdown-item" href="../articles/mixed.html">Mixed models</a></li>
    <li><a class="dropdown-item" href="../articles/multi.html">Multiple outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/visreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Contrast vs. conditional plots</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/visreg/blob/master/vignettes/articles/contrast.rmd" class="external-link"><code>vignettes/articles/contrast.rmd</code></a></small>
      <div class="d-none name"><code>contrast.rmd</code></div>
    </div>

    
    
<p>Conditional plots were discussed in <a href="basic.html">getting
started</a>. The downside of a conditional plot is that all of the terms
in the model must be specified – i.e., to plot the relationship between
wind and ozone, we also need to specify a value for temperature (or use
the median as a default). Specifically, letting <span class="math inline">x</span> denote the predictor of interest, <span class="math inline">y</span> the outcome, and <span class="math inline">\mathbf{X}_{-j}</span> the other predictors in the
model, a conditional plot represents the relationship <span class="math inline">f(x) = \mathbb{E}(Y | x,
\mathbf{X}_{-j})</span>.</p>
<p>As an alternative, we could consider relative changes, or as they are
called in statistics, <em>contrasts</em>. To be specific, let <span class="math inline">x_0</span> denote a reference value for, e.g., wind,
and consider plotting <span class="math inline">f(x) = \mathbb{E}(Y | x)
- \mathbb{E}(Y | x_0)</span>. Readers who have taken a course in
regression will recognize that this is one of the defining
characteristics of a <em>regression</em> model: a one-unit change in
<span class="math inline">x</span> has the same effect on <span class="math inline">\mathbb{E}(Y)</span> regardless of what the other
terms in the model are. Models outside the regression framework, such as
<a href="blackbox.html">random forests and support vector machines</a>,
do not have this property, and therefore, may only be visualized with
conditional plots.</p>
<p>To summarize, the primary advantage of a contrast plot is that we
don’t have to specify <span class="math inline">\mathbf{X}_{-j}</span>,
while the primary disadvantage is that we have to specify a reference
value <span class="math inline">\mathbf{x}_0</span>. By default, the
reference value in <code>visreg</code> for a numeric variable is its
mean, and for a factor its first, or reference, level.</p>
<p>To see how contrast plots compare to conditional plots, let’s fit the
same model as in <a href="basic.html">getting started</a>, but display
contrast plots and conditional plots side-by-side:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airquality</span><span class="op">$</span><span class="va">Heat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Temp</span>, <span class="fl">3</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cool"</span>, <span class="st">"Mild"</span>, <span class="st">"Hot"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">Solar.R</span> <span class="op">+</span> <span class="va">Wind</span> <span class="op">+</span> <span class="va">Heat</span>, data<span class="op">=</span><span class="va">airquality</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"Wind"</span>, type<span class="op">=</span><span class="st">"conditional"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"Wind"</span>, type<span class="op">=</span><span class="st">"contrast"</span><span class="op">)</span></span></code></pre></div>
<p><img src="contrast_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"Heat"</span>, type<span class="op">=</span><span class="st">"conditional"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/visreg.html">visreg</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"Heat"</span>, type<span class="op">=</span><span class="st">"contrast"</span><span class="op">)</span></span></code></pre></div>
<p><img src="contrast_files/figure-html/unnamed-chunk-3-2.png" width="100%"></p>
<p>The similarity between the plots is that the slopes of the lines, and
the differences between the levels of <code>Heat</code>, are exactly the
same in both plots. However, the vertical axes and the confidence
intervals are different. In particular, the confidence interval for a
contrast plot has zero width at the reference level: we can say with
certainty that <span class="math inline">\mathbb{E}(Y | x_0) -
\mathbb{E}(Y | x_0)=0</span>. There is always uncertainty, however,
about the actual value of <span class="math inline">\mathbb{E}(Y)</span>
in a conditional plot for all values of <span class="math inline">x</span>. Likewise, at the mean value of wind, 9.96,
the contrast plot passes through 0 by construction, wheras the
conditional plot passes through 34.6.</p>
<p>Furthermore, even where both confidence intervals have nonzero width,
they do not have the same width, because they represent different
things. For example, the width of the confidence interval for
<code>Mild</code> heat is wider for the contrast plot than it is for the
conditional plot: there is less uncertainty about the expected value of
ozone on a mild day than there is about the difference in expected
values between mild and cool days.</p>
<p>In these documentation pages, we focus primarily on conditional plots
to avoid duplication, but all of the options and ideas we discuss carry
over to contrast plots as well. It is worth noting, however, that there
are three situations in particular where contrast plots are very
useful:</p>
<ul>
<li>Logistic regression applied to case-control studies: In such
studies, the estimation of the intercept parameter is typically
meaningless, so conditional plots are of questionable value. Contrast
plots, however, are still meaningful ways to visualize the model’s
estimates.</li>
<li>Cox relative risk (proportional hazards) models: Likewise, in Cox
models, the baseline hazard is not estimated and plots of absolute risk
are dubious, but contrast plots still useful.</li>
<li>
<a href="mixed.html">Random effect models</a>: Most random effect
modeling software cannot account for uncertainty in the random effects
when calculating standard errors for <span class="math inline">\mathbb{E}(Y)</span>. Thus, while conditional plots
may still be constructed, they will lack confidence intervals. In
contrast plots, these terms drop out, and confidence intervals may still
be constructed.</li>
</ul></main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://myweb.uiowa.edu/pbreheny/" class="external-link">Patrick Breheny</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last updated: July 27, 2025</p>
</div>

    </footer>
</div>





  </body>
</html>

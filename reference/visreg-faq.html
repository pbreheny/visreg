<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This page tries to answer some of the questions that I get
  asked most often about how to use the visreg package.  If you have a
  question that does not appear below, I can be reached at
  &amp;lt;patrick-breheny@uiowa.edu&amp;gt;."><title>Frequently Asked Questions for visreg — visreg-faq • visreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Frequently Asked Questions for visreg — visreg-faq"><meta property="og:description" content="This page tries to answer some of the questions that I get
  asked most often about how to use the visreg package.  If you have a
  question that does not appear below, I can be reached at
  &amp;lt;patrick-breheny@uiowa.edu&amp;gt;."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">visreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.7.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-basic-framework">Basic framework</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-basic-framework">
    <a class="dropdown-item" href="../articles/web/basic.html">Getting started</a>
    <a class="dropdown-item" href="../articles/web/contrast.html">Contrast vs. conditional plots</a>
    <a class="dropdown-item" href="../articles/web/trans.html">Transformations</a>
    <a class="dropdown-item" href="../articles/web/cond.html">Conditioning</a>
    <a class="dropdown-item" href="../articles/web/options.html">Graphical options</a>
    <a class="dropdown-item" href="../articles/web/gg.html">Visreg and ggplot2</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-models-with-interactions">Models with interactions</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-models-with-interactions">
    <a class="dropdown-item" href="../articles/web/cross.html">Cross-sectional plots</a>
    <a class="dropdown-item" href="../articles/web/overlay.html">Overlay plots</a>
    <a class="dropdown-item" href="../articles/web/surface.html">Surface plots</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-special-topics">Special topics</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-special-topics">
    <a class="dropdown-item" href="../articles/web/glm.html">GLMs</a>
    <a class="dropdown-item" href="../articles/web/blackbox.html">Forests, SVMs, etc.</a>
    <a class="dropdown-item" href="../articles/web/mixed.html">Mixed models</a>
    <a class="dropdown-item" href="../articles/web/multi.html">Multiple outcomes</a>
    <a class="dropdown-item" href="../articles/web/faq.html">FAQ</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pbreheny/visreg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Frequently Asked Questions for visreg</h1>
      
      <div class="d-none name"><code>visreg-faq.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This page tries to answer some of the questions that I get
  asked most often about how to use the visreg package.  If you have a
  question that does not appear below, I can be reached at
  &lt;patrick-breheny@uiowa.edu&gt;.</p>
    </div>


    <div class="section level2">
    <h2 id="frequent-asked-questions">Frequent asked questions<a class="anchor" aria-label="anchor" href="#frequent-asked-questions"></a></h2>
    <p></p><ol><li><p><b>What is the difference between 'conditional' and
      'contrast' plots?</b></p>
<p>Suppose our data looked like:</p>
<p></p><table class="table table"><tr><td>SBP</td><td>Sex</td><td>Age</td></tr><tr><td>140</td><td>M</td><td>56</td></tr><tr><td>135</td><td>F</td><td>47</td></tr></table><p>we fit a model with</p>
<p><code>fit &lt;- lm(SBP~Sex+Age)</code></p>
<p>and we want to plot the relationship between Age and SBP.  A
    'conditional' plot illustrates the relationship between the two,
    conditional on the sex being, say, Male (the default in visreg is to
    choose the most common category).</p>
<p>The 'contrast' plot in visreg, on the other hand, illustrates the
    effect on SBP of a <em>change</em> in age -- the default in visreg is
    to use the mean age as the reference point for this change.  Since
    the above model does not have an interaction, this effect will be
    the same for men and women, and thus does not require you to specify
    a sex for the plot.</p>
<p>Both conditional and contrast plots answer subtly different
    questions, and both are useful in different situations.</p></li>
<li><p><b>Can visreg can be used for mixed models (i.e., from the
      'nlme' or 'lme4' packages)?</b></p>
<p>Sort of.  The underlying basis on which visreg operates is by using
    the predict method to plot predictions from the model.  Predictions
    for mixed models are complicated.  In particular, there is no
    <code>se.fit</code> option provided by the <code>predict</code> methods in the
    <code>nlme</code> and <code>lme4</code> packages, so you cannot obtain
    confidence bands for conditional plots.  Nevertheless, <code>visreg</code>
    will produce plots of estimated coefficients and partial residuals.</p>
<p>In addition, there may be certain nesting structures among the
    covariates that <code>visreg</code> cannot be aware of; for example, if
    you are trying to plot the effect of age for various individuals,
    fixing sex at <code>sex=Male</code>, this may involve setting the sex of
    female subjects to <code>Male</code> for the sake of the plot.  Whether
    such a plot has any meaning, you will have to judge for yourself.
    In general, contrast plots are more trustworthy than than
    conditional plots, given the intricacies of setting up conditions in
    a hierarchical model.</p>    
<p>Keep in mind that depending on what sort of predictions (BLUPs) you
    are interested in, you may need to manually control the inclusion
    of random effects in your predictions.  By default, visreg includes
    no random effects (i.e., <code>level=0</code> for <code>nlme</code> models and
    <code>re.form=NA</code> for <code>lme4</code> models).  If you are including a
    random effect as a <code>by</code> variable in <code>visreg</code>, you most
    likely want to add those effects back in, and you will have to do so
    manually, by directly specifying the appropriate <code>level</code> or
    <code>re.form</code> argument to <code>predict</code> (see <code>?predict.nlme</code>
    or <code>?predict.merMod</code>).  Handling this appropriately is the
    user's responsibility; I cannot hope to automatically decide this
    for all possible mixed models that could be passed to visreg.</p>
<p>As mentioned above, you cannot obtain confidence bands for
    conditional plots.  In the words of the authors of the <code>lme4</code>
    package, "There is no option for computing standard errors of
    predictions because it is difficult to define an efficient method
    that incorporates uncertainty in the variance parameters"; hence no
    <code>se.fit</code> option.  You can, however, get confidence bands for
    <code>'contrast'</code> plots.  In a contrast plot, the random effects
    cancel and the above issue is avoided.</p>
<p>If you are running into difficulty using <code>visreg</code> with mixed
    models, feel free to e-mail me; mixed models have been less
    extensively tested with <code>visreg</code> than fixed-effect models, and
    there may still be bugs to work out.</p></li>
<li><p><b>How do I use visreg for a model with offset terms?</b></p>
<p>By default, visreg is set up to provide conditional plots in which
    all other terms are set to their median value (or most common
    category).  This includes offset terms.  It is not uncommon,
    however, to want to see results with the offset included.  To obtain
    these results, one needs to specify the offset among the arguments
    to cond. For example, using the Insurance data from the MASS
    package:</p>
<p><code>utils::data(Insurance, package="MASS")</code><br><code>fit &lt;- glm(Claims ~ District + Group + Age +
      offset(log(Holders)), data = Insurance, family = poisson)</code><br><code>visreg(fit, "Group", scale="response")</code><br></p>
<p>This will provide the model's predictions for the expected number of
    claims given the median number of holders (here, 136).  To obtain
    the expected number of claims per holder, we need to specify
    Holders=1 in cond:</p>
<p><code>visreg(fit, "Group", scale="response", cond=list(Holders=1))</code></p>
<p>Note also that to ensure proper functionality with all of visreg's
    options, the use of the <code><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset()</a></code> function, rather than the
    <code>offset=</code> argument, is recommended.</p></li>
<li><p><b>Why doesn't visreg work with models I fit with package
      XXX?</b></p>
<p><code><a href="visreg.html">visreg()</a></code> relies on being able to call certain generic
    functions to interface with the fitted model object that is passed
    to it.  Specifically, if <code>fit</code> is the fit of a model that is
    passed to <code>visreg</code>, the following have to work:</p>
<p><code>model.frame(fit)</code>
    <code>formula(fit)</code></p>
<p>If they do not, there is nothing I can really do on the
    <code>visreg</code> end to get it to work -- the author of the package
    would need to add support for those generic functions to make it
    more portable.  If the above lines of code <em>do</em> work and
    <code>visreg</code> still fails, please let me know -- perhaps there is a
    bug somewhere that I can fix.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Patrick Breheny and Woodrow Burchett</p>  
<p>Maintainer: Patrick Breheny &lt;patrick-breheny@uiowa.edu&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p></p><ul><li><p><a href="https://pbreheny.github.io/visreg" class="external-link">https://pbreheny.github.io/visreg</a></p></li>
<li><p>Breheny, P. and Burchett, W. (2017), Visualizing regression
    models using visreg.
    <a href="https://journal.r-project.org/archive/2017/RJ-2017-046/index.html" class="external-link">https://journal.r-project.org/archive/2017/RJ-2017-046/index.html</a></p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://myweb.uiowa.edu/pbreheny/" class="external-link">Patrick Breheny</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Last updated 2022-05-11</p>
</div>

    </footer></div>

  

  

  </body></html>

